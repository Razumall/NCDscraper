NCDscraper
====

NCDから自分の経験症例を抽出するためのスクリプトです。基本的には一般外科医 (消化器外科・小児外科・心臓血管外科・呼吸器外科・乳腺外科) のためのものですが、少し改良すればNCDのシステムを採用している循環器内科医・泌尿器科にも応用できるかもしれません。

# 開発経緯
今までの自分の経験症例数を算出する必要があったのですが、一般外科医であれば、自分の登録症例はすべてNCDに登録されていると思います。[NCD検索システム](https://user.ncd.or.jp/member/memberLogin.html)にアクセスすればいいのですが、ここで大きな問題が。手術症例数の件数表示は、施設別、術式別、術者別に一覧表示できるのですが、

* 施設・術者・術式の複数を組み合わせたフィルタリングができない
* 手術は20件ずつ表示されて、それ以上の設定はできない
* もちろん`.csv`での一括ダウンロードなんてもっての他

という仕様になっていました。さすがに手間がかかりすぎるので、Sleniumでscrapingすることにしました。Seleniumとは一言で言ってしまえば、自動でブラウザを操作する為のライブラリとのことです。

# Requirement
* macOS Mojave+: 他のOSには対応できていません
* Python 3.6+
* Google Chrome
* Selenium
* ChromeDriver

セットアップについては拙ブログ[ (Note of Pediatric Surgey) ](https://www.pediatricsurgery.site/)の[SeleniumとPythonでスクレイピングをやるために必要な準備](https://www.pediatricsurgery.site/entry/2019/12/15/143053)という記事にまとめてありますので、こちらを参照にしてください。

# Usage
`NCDscraper.py`のスクリプトの中で、自身で変更する必要があるのは3つです。

1. '自身のログインIDを入力'
2. '自身のパスワードを入力'
3. 'ページ数-1を入力'

それぞれ該当する値に変更してください。'ページ数-1'とは、例えば110件手術があるならば、110[件] / 20[件/ページ] = 5[ページ]で1を引いて`4`とします。これらを変更したあと、Python3をターミナルを起動し、スクリプトをすべて貼り付けて実行すれば、Chromeが起動し、自動処理したあと、デスクトップにCSVファイルが吐き出されていると思います。

# Recommendation
スクリプトの内容の解説は拙ブログ [(Note of Pediatric Surgey)](https://www.pediatricsurgery.site/) の[SeleniumでNCD検索システムから全経験手術症例を1つのCSVファイルに抽出する](https://www.pediatricsurgery.site/entry/2019/12/15/143053)にまとめてありますので、もしよろしければご参照ください。

# Todo
* 実はまだ最後の1ページを上手くscrapingできないというエラーがあります (最後の1ページの件数は端数になるので不定であり、そこのうまい処理ができていません)
* ページ数を自動取得するスクリプトを書く

# Licence
以下の条件を満たす限り、自由な複製・配布・修正を無制限に許可します。
* 上記の著作権表示と本許諾書を、ソフトウェアの複製または重要な部分に記載する
* 本ソフトウェアは無保証である。自己責任で使用する。

詳しくは`License.md`を参照ください。